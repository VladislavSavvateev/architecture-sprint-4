# Мотивация

Мониторинг - это хороший способ для понимания состояния системы в любой момент времени. Собирая и аккумулируя метрики,
можно делать различные выводы. Например, справляется ли сейчас сервер API, нужно ли по вечерам докидывать дополнительные
ноды в места с высокой нагрузкой, когда пользователи пришли после работы домой и решили воспользоваться сервисом все
сразу. Внедрение мониторинга поможет заранее прогнозировать различные кризисные ситуации и разрабатывать решения для их
нивелирования, что в свою очередь поможет не понести убытки и даже увеличить прибыль компании.

# Выбор подхода к мониторингу

- Shop: RED
- CRM: RED
- MES: USE

## Shop: RED

В качестве Requests Rate (R) будет использоваться `Number of requests (RPS) for internet shop API`. Она поможет увидеть
текущую нагрузку на сервис через количество запросов к API магазина в секунду. 

Для Errors (E) будет использоваться `Number of HTTP 500 for shop API`. Эта метрика сможет подсказать, в какой момент 
времени происходят обвалы запросов, а сравнивая с количеством запросов в секунду можно установить корреляцию между этими 
двумя метриками.

Для Duration (D) будет использоваться `Response time (latency) for shop API`. В отрыве от трассировки эта метрика имеет 
мало смысла, но сопоставляя с количеством запросов в секунду можно видеть, влияет ли большой наплыв запросов на время
обработки запросов (например, можно использовать для сигнализации о том, что пора настраивать кэширование).

## CRM: RED

Здесь подход сравним с тем, который применён в Shop.

Requests Rate (R): `Number of requests (RPS) for CRM API`
Errors (E): `Number of HTTP 500 for CRM API`
Duration (D): `Response time (latency) for CRM API`

## MES: USE

Здесь уже сложнее. Поскольку MES - это сервис, который имеет под собой не только API, но и сложный алгоритм вычисления
стоимости заказа, нужно следить и за другими метриками.

Для Utilization (U) лучше всего взять `CPU % for MES API`. Эта метрика позволить отслеживать моменты нагрузки на сервис,
а также покажет, имеется ли дополнительное пространство для манёвра, например, для увеличения количества одновременно 
обрабатываемых заказов одной нодой.

Для Saturation (S) можно взять `Memory Utilisation for MES API`. Использование памяти может показать наполненность 
очереди обработки заказов, что в свою очередь может послужить толчком в направлении распараллеливания вычислений на
несколько инстансов.

Для Errors (E) можно взять `Number of HTTP 500 for MES API`. Тут принцип тот же, что и в двух прошлых сервисах.

Также можно применить дополнительно и RED-подход с тем же принципом.

# План действий

1. Развернуть Prometheus
2. Развернуть Grafana и подключить инстанс Prometheus к ней
3. Организовать сбор RED-метрик из Shop API в Prometheus
4. Визуализировать RED-метрики из Shop API в Grafana
5. Организовать сбор RED-метрик из CRM API в Prometheus
6. Визуализировать RED-метрики из CRM API в Grafana
7. Организовать сбор RED-метрик из MES API в Prometheus
8. Визуализировать RED-метрики из MES API в Grafana