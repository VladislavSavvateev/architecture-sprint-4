# Мониторинг

Список необходимых логов с уровнем INFO:

- авторизация пользователя
  - пользователь
  - IP
  - дата и время
- создание заказа
  - пользователь
  - IP
  - дата и время
- изменение статуса заказа
  - пользователь
  - IP
  - дата и время
  - новый статус
  - прошлый статус
- новый запрос на расчёт в MES
  - пользователь (или владелец API-ключа)
  - IP
  - дата и время
- окончание расчёта в MES
  - пользователь (или владелец API-ключа), отправивший запрос на расчёт
  - дата и время
  - время, затраченное на расчёт

Также было бы неплохо добавить следующие логи с уровнем WARNING:

- неудачная попытка авторизации
  - данные авторизации (без пароля)
  - IP 
  - дата и время

Также можно добавить глобальные обработчики неперехваченных исключений во всех сервисах и логгировать их с уровнем 
ERROR.

# Мотивация

Мониторинг может помочь с отладкой неполадок на продакшне, а также выявить различные неприятные ситуации, по типу 
брутфорса. Пренебрегать внедрением мониторинга не стоит, так как в последствии может оказаться ситуация, когда логи 
действительно нужны прямо сейчас.

# Предлагаемое решение

Для мониторинга будет использоваться ELK-стек: Logstash будет собирать логи и хранить их в ElasticSearch, а разработчик
(или любой человек, имеющий доступ к логам) сможет их увидеть с помощью Kibana. Логи не должны содержать чувствительные 
данные, такие как персональные данные или пароли. Исключение - IP-адреса, необходимые для определения потенциальных
брутфорс-атак. Доступ к логам стоит выдать только тем, кому эти логи будут полезны, например, разработчикам для решения
багов. Кажется, что хранить логи дольше двух недель не имеет много смысла, поскольку более старые логи могут быть уже не
релевантны.

Для логов уровня WARNING стоит настроить алерты "больше 10 событий в секунду с одного IP". В таких ситуациях можно
предположить, что происходит возможная атака. Для лога с новым запросов на расчёт в MES стоит настроить алерт "больше 10 
событий в минуту", поскольку движок не слишком быстрый, и очередь может быть очень быстро заполнена. Для логов уровня 
ERROR стоит делать незамедлительные алерты, чтобы быстро реагировать на баги. 