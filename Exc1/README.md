# Проблемные места

Изучая схему и описание системы, я обнаружил следующие проблемные места

- отсутствие масштабирования MES-части;
- отсутствие очереди заказов в MES-части;
- отсутствие кэширования списка заказов.

Возникает ощущение, что проблемы с производительностью возникают из-за нехватки ресурсов для расчётов. В свою очередь, это решается либо оптимизацией MES (долго и дорого), либо горизонтальным масштабированием (не так долго и не так дорого). Для решения этой проблемы можно было бы организовать очередь обработки заказов, из которой несколько инстансов MES могли бы забирать заказы на обработку. Для этого также потребуется изменение в статусную модель заказа, а именно добавление статуса IN_QUEUE. В случае наплыва пользователей в связи с сезонностью или прочими факторами можно спокойно делать скейлинг, тем самым уменьшая время обработки очереди заказов. 
Долгие запросы на получение списка заказов и фильтрации заказов можно решить совмещением пагинации и кэширования запросов. Например, можно кэшировать список заказов и заказы по отдельности (если это требуется), инвалидировать список заказов при добавлении нового заказа и инвалидировать отдельные заказы при изменении статуса заказа и появлении артефактов расчёта.
В дополнении хочется отметить отсутствие репликации и шардинга БД у каждого из сервисов. Потеря данных для такой компании может сильно ударить по финансам, поэтому стоит задуматься об архитектурных изменениях на уровне БД.
Также стоит отметить то, что движок расчёта и REST API сервиса MES - это монолит (по крайней мере, так кажется по схеме). Из-за чего повышенная нагрузка на движок бьёт по скорости обработки остальных запросов. В целом, эта проблема может быть решена так же, как и первая проблема: достаточно вынести сложную логику расчёта как отдельный микросервис.

Вышеперечисленные инициативы я бы распределил в следующем порядке по приоритету:

- Настройка кэширования (это не долго и не дорого);
- Вынесение движка расчёта в отдельный микросервис (это зависимость для остальных инициатив);
- Формирование очереди заказов в MES для передачи в отдельный микросервис (микросервис будет ходить в MES за новыми заказами для обработки);
- Горизонтальное масштабирование микросервисов движка расчёта.
